2023-07-13T11:14:21.137728950Z istio-proxy 2023-07-13T11:14:21.137663Z    info    dns    Starting local udp DNS server on 127.0.0.1:15053
2023-07-13T11:14:21.137850680Z istio-proxy 2023-07-13T11:14:21.137823Z    info    dns    Starting local tcp DNS server on 127.0.0.1:15053
2023-07-13T11:14:21.137984133Z istio-proxy 2023-07-13T11:14:21.137966Z    info    citadelclient    Citadel client using custom root cert: var/run/secrets/istio/root-cert.pem
2023-07-13T11:14:21.147823912Z istio-proxy 2023-07-13T11:14:21.147788Z    info    ads    All caches have been synced up in 15.682774ms, marking server ready
2023-07-13T11:14:21.148010094Z istio-proxy 2023-07-13T11:14:21.147991Z    info    xdsproxy    Initializing with upstream address "istiod-basic.istio-system.svc:15012" and cluster "Kubernetes"
2023-07-13T11:14:21.945307452Z user-container Starting server
2023-07-13T11:14:21.148081038Z istio-proxy 2023-07-13T11:14:21.148051Z    info    sds    Starting SDS grpc server
2023-07-13T11:14:21.198681103Z istio-proxy 2023-07-13T11:14:21.198634Z    info    xdsproxy    connected to upstream XDS server: istiod-basic.istio-system.svc:15012
2023-07-13T11:14:21.246559243Z istio-proxy 2023-07-13T11:14:21.246509Z    info    ads    ADS: new connection for node:timeout-00001-deployment-7c5bfd9694-g5xhn.serving-tests-1
2023-07-13T11:14:21.246591975Z istio-proxy 2023-07-13T11:14:21.246561Z    info    ads    ADS: new connection for node:timeout-00001-deployment-7c5bfd9694-g5xhn.serving-tests-2
2023-07-13T11:14:21.283987892Z istio-proxy 2023-07-13T11:14:21.283948Z    info    cache    generated new workload certificate    latency=136.002575ms ttl=23h59m59.71606094s
2023-07-13T11:14:22.119757570Z queue-proxy {"severity":"DEBUG","timestamp":"2023-07-13T11:14:22.119642352Z","caller":"logging/config.go:116","message":"Successfully created the logger."}
2023-07-13T11:14:22.119757570Z queue-proxy {"severity":"DEBUG","timestamp":"2023-07-13T11:14:22.119722704Z","caller":"logging/config.go:117","message":"Logging level set to: debug"}
2023-07-13T11:14:22.120062266Z queue-proxy {"severity":"INFO","timestamp":"2023-07-13T11:14:22.120035305Z","logger":"queueproxy","caller":"sharedmain/main.go:270","message":"Starting queue-proxy","commit":"35789c9-dirty","knative.dev/key":"serving-tests/timeout-00001","knative.dev/pod":"timeout-00001-deployment-7c5bfd9694-g5xhn"}
2023-07-13T11:14:21.283987892Z istio-proxy 2023-07-13T11:14:21.283973Z    info    cache    Root cert has changed, start rotating root cert
2023-07-13T11:14:21.283987892Z istio-proxy 2023-07-13T11:14:21.283984Z    info    ads    XDS: Incremental Pushing:0 ConnectedEndpoints:2 Version:
2023-07-13T11:14:21.284043637Z istio-proxy 2023-07-13T11:14:21.284031Z    info    cache    returned workload trust anchor from cache    ttl=23h59m59.715972473s
2023-07-13T11:14:21.284051201Z istio-proxy 2023-07-13T11:14:21.284047Z    info    cache    returned workload certificate from cache    ttl=23h59m59.715954599s
2023-07-13T11:14:21.284149157Z istio-proxy 2023-07-13T11:14:21.284131Z    info    cache    returned workload trust anchor from cache    ttl=23h59m59.715874287s
2023-07-13T11:14:21.284196966Z istio-proxy 2023-07-13T11:14:21.284187Z    info    ads    SDS: PUSH request for node:timeout-00001-deployment-7c5bfd9694-g5xhn.serving-tests resources:1 size:4.0kB resource:default
2023-07-13T11:14:21.284265075Z istio-proxy 2023-07-13T11:14:21.284254Z    info    ads    SDS: PUSH request for node:timeout-00001-deployment-7c5bfd9694-g5xhn.serving-tests resources:1 size:1.1kB resource:ROOTCA
2023-07-13T11:14:21.284305442Z istio-proxy 2023-07-13T11:14:21.284297Z    info    cache    returned workload trust anchor from cache    ttl=23h59m59.71570558s
2023-07-13T11:14:22.120071404Z queue-proxy {"severity":"INFO","timestamp":"2023-07-13T11:14:22.120055955Z","logger":"queueproxy","caller":"sharedmain/main.go:276","message":"Starting http server metrics:9090","commit":"35789c9-dirty","knative.dev/key":"serving-tests/timeout-00001","knative.dev/pod":"timeout-00001-deployment-7c5bfd9694-g5xhn"}
2023-07-13T11:14:22.120086462Z queue-proxy {"severity":"INFO","timestamp":"2023-07-13T11:14:22.120077084Z","logger":"queueproxy","caller":"sharedmain/main.go:276","message":"Starting http server main:8012","commit":"35789c9-dirty","knative.dev/key":"serving-tests/timeout-00001","knative.dev/pod":"timeout-00001-deployment-7c5bfd9694-g5xhn"}
2023-07-13T11:14:22.120119354Z queue-proxy {"severity":"INFO","timestamp":"2023-07-13T11:14:22.120100358Z","logger":"queueproxy","caller":"sharedmain/main.go:276","message":"Starting http server admin:8022","commit":"35789c9-dirty","knative.dev/key":"serving-tests/timeout-00001","knative.dev/pod":"timeout-00001-deployment-7c5bfd9694-g5xhn"}
2023-07-13T11:14:23.775346297Z queue-proxy {"httpRequest": {"requestMethod": "GET", "requestUrl": "/", "requestSize": "0", "status": 200, "responseSize": "5", "userAgent": "kube-probe/1.26", "remoteIp": "127.0.0.6:45521", "serverIp": "10.128.1.97", "referer": "", "latency": "0.000129275s", "protocol": "HTTP/1.1"}, "traceId": "[]"}
2023-07-13T11:14:24.031862430Z queue-proxy {"httpRequest": {"requestMethod": "GET", "requestUrl": "/healthz", "requestSize": "0", "status": 200, "responseSize": "5", "userAgent": "Knative-Activator-Probe", "remoteIp": "127.0.0.6:53933", "serverIp": "10.128.1.97", "referer": "", "latency": "0.000140747s", "protocol": "HTTP/1.1"}, "traceId": "[6ff6f51f8dc5d02b4c4f8d01ae8a30a7]"}
2023-07-13T11:14:24.032226758Z istio-proxy { "authority": "172.30.228.206:80", "bytes_received": 0, "bytes_sent": 5, "downstream_local_address": "10.128.1.97:8012", "downstream_peer_cert_v_end": "2023-07-14T09:18:00.000Z", "downstream_peer_cert_v_start": "2023-07-13T09:16:00.000Z", "downstream_remote_address": "10.128.1.25:48652", "downstream_tls_cipher": "TLS_AES_256_GCM_SHA384", "downstream_tls_version": "TLSv1.3", "duration": 0, "hostname": "timeout-00001-deployment-7c5bfd9694-g5xhn", "istio_policy_status": "-", "method": "GET", "path": "/healthz", "protocol": "HTTP/1.1", "request_duration": 0, "request_id": "3b7205c7-1497-4e1c-8320-c620d515f114", "requested_server_name": "outbound_.80_._.timeout-00001-private.serving-tests.svc.cluster.local", "response_code": "200", "response_duration": 0, "response_tx_duration": 0, "response_flags": "-", "route_name": "default", "start_time": "2023-07-13T11:14:24.031Z", "upstream_cluster": "inbound|8012||", "upstream_host": "10.128.1.97:8012", "upstream_local_address": "127.0.0.6:53933", "upstream_service_time": 0, "upstream_transport_failure_reason": "-", "user_agent": "Knative-Activator-Probe", "x_forwarded_for": "-" }
2023-07-13T11:14:24.036447286Z queue-proxy {"httpRequest": {"requestMethod": "GET", "requestUrl": "/healthz", "requestSize": "0", "status": 200, "responseSize": "5", "userAgent": "Knative-Activator-Probe", "remoteIp": "127.0.0.6:44145", "serverIp": "10.128.1.97", "referer": "", "latency": "0.000205268s", "protocol": "HTTP/1.1"}, "traceId": "[78b2e072e2adf93a1f49fbb66ae158c4]"}
2023-07-13T11:14:24.038857101Z user-container Writing http OK to response
2023-07-13T11:14:24.038857101Z user-container f.Flush()
2023-07-13T11:14:24.038923817Z user-container Before sleep
2023-07-13T11:14:30.463777334Z queue-proxy {"httpRequest": {"requestMethod": "GET", "requestUrl": "/", "requestSize": "0", "status": 200, "responseSize": "5", "userAgent": "kube-probe/1.26", "remoteIp": "127.0.0.6:46953", "serverIp": "10.128.1.97", "referer": "", "latency": "0.000143972s", "protocol": "HTTP/1.1"}, "traceId": "[]"}
2023-07-13T11:14:37.349550492Z istio-proxy 2023-07-13T11:14:37.349061Z    error    accept tcp :15020: use of closed network connection
2023-07-13T11:14:37.390023975Z queue-proxy {"severity":"INFO","timestamp":"2023-07-13T11:14:37.389950586Z","logger":"queueproxy","caller":"sharedmain/handlers.go:120","message":"Attached drain handler from user-container&{GET /wait-for-drain HTTP/1.1 1 1 map[Accept:[*/*] Accept-Encoding:[gzip] User-Agent:[kube-lifecycle/1.26] X-B3-Sampled:[0] X-B3-Spanid:[fef424a0dcbfc80b] X-B3-Traceid:[04643d8b46061f21fef424a0dcbfc80b] X-Forwarded-Proto:[http] X-Request-Id:[7269890f-b883-4f31-ae82-391ef132f734]] {} <nil> 0 [] false 10.128.1.97:8022 map[] map[] <nil> map[] 127.0.0.6:59035 /wait-for-drain <nil> <nil> <nil> 0xc000418600}","commit":"35789c9-dirty","knative.dev/key":"serving-tests/timeout-00001","knative.dev/pod":"timeout-00001-deployment-7c5bfd9694-g5xhn"}
2023-07-13T11:14:37.413559693Z queue-proxy {"severity":"INFO","timestamp":"2023-07-13T11:14:37.406569319Z","logger":"queueproxy","caller":"sharedmain/main.go:303","message":"Received TERM signal, attempting to gracefully shutdown servers.","commit":"35789c9-dirty","knative.dev/key":"serving-tests/timeout-00001","knative.dev/pod":"timeout-00001-deployment-7c5bfd9694-g5xhn"}
2023-07-13T11:14:37.413559693Z queue-proxy {"severity":"INFO","timestamp":"2023-07-13T11:14:37.406641476Z","logger":"queueproxy","caller":"sharedmain/main.go:304","message":"Sleeping 30s to allow K8s propagation of non-ready state","commit":"35789c9-dirty","knative.dev/key":"serving-tests/timeout-00001","knative.dev/pod":"timeout-00001-deployment-7c5bfd9694-g5xhn"}
2023-07-13T11:14:38.463690721Z istio-proxy 2023-07-13T11:14:38.463636Z    warn    Envoy proxy is NOT ready: server is not live, current state is: DRAINING
2023-07-13T11:14:40.463627132Z istio-proxy 2023-07-13T11:14:40.462915Z    warn    Envoy proxy is NOT ready: server is not live, current state is: DRAINING
2023-07-13T11:14:42.462890140Z istio-proxy 2023-07-13T11:14:42.462844Z    warn    Envoy proxy is NOT ready: server is not live, current state is: DRAINING
2023-07-13T11:14:44.462689691Z istio-proxy 2023-07-13T11:14:44.462654Z    warn    Envoy proxy is NOT ready: server is not live, current state is: DRAINING
2023-07-13T11:14:46.463273986Z istio-proxy 2023-07-13T11:14:46.463222Z    warn    Envoy proxy is NOT ready: server is not live, current state is: DRAINING
2023-07-13T11:14:48.463680203Z istio-proxy 2023-07-13T11:14:48.463565Z    warn    Envoy proxy is NOT ready: server is not live, current state is: DRAINING
2023-07-13T11:14:50.463345492Z istio-proxy 2023-07-13T11:14:50.463299Z    warn    Envoy proxy is NOT ready: server is not live, current state is: DRAINING
2023-07-13T11:14:52.462673521Z istio-proxy 2023-07-13T11:14:52.462631Z    warn    Envoy proxy is NOT ready: server is not live, current state is: DRAINING
2023-07-13T11:14:54.463335903Z istio-proxy 2023-07-13T11:14:54.463290Z    warn    Envoy proxy is NOT ready: server is not live, current state is: DRAINING
2023-07-13T11:14:56.462835548Z istio-proxy 2023-07-13T11:14:56.462798Z    warn    Envoy proxy is NOT ready: server is not live, current state is: DRAINING
2023-07-13T11:14:58.462671218Z istio-proxy 2023-07-13T11:14:58.462628Z    warn    Envoy proxy is NOT ready: server is not live, current state is: DRAINING
2023-07-13T11:14:59.044549335Z user-container After sleep
2023-07-13T11:14:59.044549335Z user-container After response write
2023-07-13T11:14:59.044985619Z queue-proxy {"httpRequest": {"requestMethod": "GET", "requestUrl": "/?timeout\u003D35000", "requestSize": "0", "status": 200, "responseSize": "28", "userAgent": "curl/7.88.1", "remoteIp": "127.0.0.6:44145", "serverIp": "10.128.1.97", "referer": "", "latency": "35.006877524s", "protocol": "HTTP/1.1"}, "traceId": "[01b2ab3de6b0794ac2a0b7f38ea0496b]"}
2023-07-13T11:14:59.315599750Z istio-proxy { "authority": "172.30.228.206:80", "bytes_received": 0, "bytes_sent": 28, "downstream_local_address": "10.128.1.97:8012", "downstream_peer_cert_v_end": "2023-07-14T09:18:01.000Z", "downstream_peer_cert_v_start": "2023-07-13T09:16:01.000Z", "downstream_remote_address": "127.0.0.6:0", "downstream_tls_cipher": "TLS_AES_256_GCM_SHA384", "downstream_tls_version": "TLSv1.3", "duration": 35007, "hostname": "timeout-00001-deployment-7c5bfd9694-g5xhn", "istio_policy_status": "-", "method": "GET", "path": "/?timeout=35000", "protocol": "HTTP/1.1", "request_duration": 0, "request_id": "d87ce5cf-8753-43c2-b4c7-513508456c31", "requested_server_name": "outbound_.80_._.timeout-00001-private.serving-tests.svc.cluster.local", "response_code": "200", "response_duration": 1, "response_tx_duration": 35005, "response_flags": "-", "route_name": "default", "start_time": "2023-07-13T11:14:24.037Z", "upstream_cluster": "inbound|8012||", "upstream_host": "10.128.1.97:8012", "upstream_local_address": "127.0.0.6:44145", "upstream_service_time": 1, "upstream_transport_failure_reason": "-", "user_agent": "curl/7.88.1", "x_forwarded_for": "10.128.0.2, 127.0.0.6" }
2023-07-13T11:15:00.463048089Z istio-proxy 2023-07-13T11:15:00.462990Z    warn    Envoy proxy is NOT ready: server is not live, current state is: DRAINING
2023-07-13T11:15:02.462959382Z istio-proxy 2023-07-13T11:15:02.462913Z    warn    Envoy proxy is NOT ready: server is not live, current state is: DRAINING
2023-07-13T11:15:04.463858401Z istio-proxy 2023-07-13T11:15:04.463759Z    warn    Envoy proxy is NOT ready: server is not live, current state is: DRAINING
2023-07-13T11:15:06.463235544Z istio-proxy 2023-07-13T11:15:06.463193Z    warn    Envoy proxy is NOT ready: server is not live, current state is: DRAINING
2023-07-13T11:15:07.390617250Z queue-proxy {"severity":"INFO","timestamp":"2023-07-13T11:15:07.390502062Z","logger":"queueproxy","caller":"sharedmain/main.go:308","message":"Shutting down server: admin","commit":"35789c9-dirty","knative.dev/key":"serving-tests/timeout-00001","knative.dev/pod":"timeout-00001-deployment-7c5bfd9694-g5xhn"}
2023-07-13T11:15:07.390708172Z queue-proxy {"severity":"INFO","timestamp":"2023-07-13T11:15:07.390647717Z","logger":"queueproxy","caller":"sharedmain/main.go:308","message":"Shutting down server: metrics","commit":"35789c9-dirty","knative.dev/key":"serving-tests/timeout-00001","knative.dev/pod":"timeout-00001-deployment-7c5bfd9694-g5xhn"}
2023-07-13T11:15:07.390866522Z queue-proxy {"severity":"INFO","timestamp":"2023-07-13T11:15:07.390794445Z","logger":"queueproxy","caller":"sharedmain/main.go:308","message":"Shutting down server: main","commit":"35789c9-dirty","knative.dev/key":"serving-tests/timeout-00001","knative.dev/pod":"timeout-00001-deployment-7c5bfd9694-g5xhn"}
2023-07-13T11:15:07.390930402Z queue-proxy {"severity":"INFO","timestamp":"2023-07-13T11:15:07.390889365Z","logger":"queueproxy","caller":"sharedmain/main.go:319","message":"Shutdown complete, exiting...","commit":"35789c9-dirty","knative.dev/key":"serving-tests/timeout-00001","knative.dev/pod":"timeout-00001-deployment-7c5bfd9694-g5xhn"}
2023-07-13T11:15:07.425201582Z user-container Got first Signal
2023-07-13T11:15:07.425252979Z user-container server.Shutdown() called
2023-07-13T11:15:07.425314536Z user-container Server stopped
2023-07-13T11:15:08.318636411Z istio-proxy { "authority": "10.128.1.97:8022", "bytes_received": 0, "bytes_sent": 0, "downstream_local_address": "10.128.1.97:8022", "downstream_peer_cert_v_end": "-", "downstream_peer_cert_v_start": "-", "downstream_remote_address": "10.128.0.2:46694", "downstream_tls_cipher": "-", "downstream_tls_version": "-", "duration": 30001, "hostname": "timeout-00001-deployment-7c5bfd9694-g5xhn", "istio_policy_status": "-", "method": "GET", "path": "/wait-for-drain", "protocol": "HTTP/1.1", "request_duration": 0, "request_id": "7269890f-b883-4f31-ae82-391ef132f734", "requested_server_name": "-", "response_code": "200", "response_duration": 30001, "response_tx_duration": 0, "response_flags": "-", "route_name": "default", "start_time": "2023-07-13T11:14:37.389Z", "upstream_cluster": "inbound|8022||", "upstream_host": "10.128.1.97:8022", "upstream_local_address": "127.0.0.6:59035", "upstream_service_time": 30001, "upstream_transport_failure_reason": "-", "user_agent": "kube-lifecycle/1.26", "x_forwarded_for": "-" }
2023-07-13T11:15:08.397162Z    Stream closed EOF for serving-tests/timeout-00001-deployment-7c5bfd9694-g5xhn (queue-proxy)
2023-07-13T11:15:08.431871Z    Stream closed EOF for serving-tests/timeout-00001-deployment-7c5bfd9694-g5xhn (user-container)
2023-07-13T11:15:08.463158659Z istio-proxy 2023-07-13T11:15:08.463110Z    warn    Envoy proxy is NOT ready: server is not live, current state is: DRAINING
2023-07-13T11:15:10.463093637Z istio-proxy 2023-07-13T11:15:10.463057Z    warn    Envoy proxy is NOT ready: server is not live, current state is: DRAINING
2023-07-13T11:15:12.358746578Z istio-proxy 2023-07-13T11:15:12.358677Z    warn    Aborted proxy instance
2023-07-13T11:15:12.358746578Z istio-proxy 2023-07-13T11:15:12.358718Z    warn    Aborting proxy
2023-07-13T11:15:13.248793Z    Stream closed EOF for serving-tests/timeout-00001-deployment-7c5bfd9694-g5xhn (istio-proxy)
